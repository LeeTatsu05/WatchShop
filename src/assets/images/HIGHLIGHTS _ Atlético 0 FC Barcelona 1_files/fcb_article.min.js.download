"use strict";PULSE.app.templates["related-articles-list"]=_.template('<div class="related-articles__title"> <b><%= PULSE.I18N.lookup(\'label.content.related\') %></b> <%= PULSE.I18N.lookup(\'label.content.related.tothisstory\') %> </div> <ul class="related-articles__list"> <% _.forEach(articles, function(article) { %> <% articleTag = TEMPLATE_HELPER.getMediaTag(article.tags) %> <% isFeatured = TEMPLATE_HELPER.contentHasTag(article.tags, \'Feature\') %> <li class="related-articles__item"> <a href="<% if (article.hotlinkUrl) { %> <%= article.hotlinkUrl %> <% } else { %></a><%= URL_HELPER.generateUrl(\'text\', article.id, isFeatured ? \'featured\' : null, article.title) %><% } %>" class="related-articles__link" <% if (article.hotlinkUrl) { %> rel="noopener" target="_blank" <% } %>> <% if (article.subtitle) { %> <span class="related-articles__article-title"><%= article.subtitle %></span> <% } else { %> <span class="related-articles__article-title"><%= article.title %></span> <% } %> <% if (articleTag) { %><span class="related-articles__tag"><%= PULSE.I18N.lookup( articleTag ) %></span><% } %> <time class="related-articles__time"> <svg class="related-articles__time-icon icon"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/<%= window.RESOURCE_VERSION %>/i/svg-output/icn.svg#clock"></use></svg> <span class="related-articles__time-date"><%= TEMPLATE_HELPER.dateAge(article.publishFrom) %></span> </time> </a> </li> <% }) %> </ul>'),function(e,t,r){var a="article-modal__close--expanded",i="js-article-footer",l="js-article-bottom",n="js-publish-date",c=function(){var e=this,t=[];return t.push(e.articleFooterElem),t.push(e.pageBottomElem),t.concat(DOM_HELPER.nodeListToArray(e.socialShareElems)).concat(DOM_HELPER.nodeListToArray(e.observableElem))},o=function(){var e=this,t={threshold:.6};e.intersectionObserver=new IntersectionObserver(function(t){t.forEach(function(t){return t.target===e.pageBottomElem?void d.call(e,t):void s.call(e,t)})},t);for(var r=0;r<e.elementsToObserve.length;r++)e.elementsToObserve[r]&&e.intersectionObserver.observe(e.elementsToObserve[r])},s=function(e){e.isIntersecting&&ANIMATION_HELPER.requestAnimationFrame(function(){r.style.addClass(e.target,CONSTANTS.STYLE_CLS_NAMES.IS_VISIBLE)})},d=function(e){var t=this;t.isModal&&ANIMATION_HELPER.requestAnimationFrame(function(){e.isIntersecting?r.style.addClass(t.config.controls.close,a):r.style.removeClass(t.config.controls.close,a)})};e.Article=function(e,t){var r=this;r.container=e,r.config=t||{},r.isModal=r.config.isModal||!1,r.socialShareElems=r.container.querySelectorAll("."+CONSTANTS.JS_CLS_NAMES.SOCIAL_SHARE),r.articleFooterElem=r.container.querySelector("."+i),r.pageBottomElem=r.container.querySelector("."+l),r.updatePublishTime(),r.observableElem=r.container.querySelectorAll("[data-observe]"),r.elementsToObserve=c.call(r),r.init()},e.Article.prototype.updatePublishTime=function(){var t=this,r=t.container.querySelector("."+n);if(r){var a=Number(t.container.dataset.publishFrom),i=moment.tz.guess(),l=moment.tz(a,i),c="ja"===e.language?"MMMD日（ddd）ah.mm":"hh:mma dddd DD MMM";r.innerText=l.format(c)}},e.Article.prototype.init=function(){var e=this;o.call(e)},e.Article.prototype.removeScrollObserver=function(){var e=this;e.intersectionObserver&&e.intersectionObserver.disconnect()};for(var u=document.querySelectorAll('[data-widget="article"]'),g=0;g<u.length;g++)new e.Article(u[g])}(PULSE.app,PULSE.app.common,PULSE.core),function(e,t,r){var a="js-article-body",i=3,l=function(){var t=this,a={url:e.apiPath.cms.text+"?"+r.url.buildQueryString({tagNames:t.tags,pageSize:t.pageSize}),method:"GET",callback:t.render,forceCallback:!0,target:t};r.data.manager.add(a)},n=function(e,t){return e.filter(function(e){return e.id!==t})};e.RelatedArticles=function(e){var t=this;t.container=e,t.articleBody=document.querySelector("."+a),t.firstTitle=t.articleBody.querySelector("h1, h2, h3"),t.thirdParagraph=t.articleBody.querySelector("p + p + p"),t.firstParagraph=t.articleBody.querySelector("p"),t.pageSize=e.getAttribute("data-page-size")||i;var r=e.getAttribute("data-additional-config"),l=document.querySelector(r);if(l){t.currentArticleId=Number(l.getAttribute("data-article-id"));var n=l.getAttribute("data-tags")||"";t.tags=n.split(","),t.tags.push(CONSTANTS.TAGS.TYPE.NEWS.tag),t.init()}},e.RelatedArticles.prototype.init=function(){var e=this;l.call(e)},e.RelatedArticles.prototype.render=function(e){var t=this;if(e.content&&0!==e.content.length){var a=n(e.content,t.currentArticleId);0!==a.length&&(t.container.innerHTML=TEMPLATE_HELPER.render({articles:a},"related-articles-list"),r.style.addClass(t.container,CONSTANTS.STYLE_CLS_NAMES.HAS_CONTENT),t.firstTitle||t.thirdParagraph?t.articleBody.insertBefore(t.container,t.firstTitle||t.thirdParagraph):t.firstParagraph&&t.firstParagraph.nextSibling&&t.articleBody.insertBefore(t.container,t.firstParagraph.nextSibling))}};for(var c=document.querySelectorAll('[data-widget="related-articles"]'),o=0;o<c.length;o++)new e.RelatedArticles(c[o])}(PULSE.app,PULSE.app.common,PULSE.core);